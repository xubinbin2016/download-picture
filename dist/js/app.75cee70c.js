(function(){"use strict";var t={4554:function(t,n,e){var o=e(6848),r=function(){var t=this,n=t._self._c;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"top"},[n("div",{staticClass:"picture-count"},[t._v(" 本相册共有"),n("span",{staticClass:"count"},[t._v(t._s(t.photoList.length))]),t._v("张照片 ")]),n("button",{staticClass:"download",on:{click:t.downLoad}},[t._v("下载所有照片")])]),n("div",{staticClass:"container"},t._l(t.photoList,(function(t,e){return n("img",{key:e,attrs:{src:t,alt:""}})})),0),t.loading?n("div",{staticClass:"loading"},[t._m(0)]):t._e()])},i=[function(){var t=this,n=t._self._c;return n("div",{staticClass:"torus-box"},[n("div",{staticClass:"torus"}),n("div",{staticClass:"torus-text"},[t._v(" 正在下载中，请耐心等待... ")])])}],s=(e(4114),e(4813)),a=e.n(s),l=e(788),u=e.n(l),c=e(8355),f={name:"App",data(){return{count:0,photoList:[],loading:!1}},created(){},mounted(){this.getPhotoList()},methods:{downJson(t){const n=this;fetch(t).then((function(t){return t.text()})).then((function(t){const e=t.indexOf("("),o=t.lastIndexOf(")"),r=JSON.parse(t.substring(e+1,o));n.photoList=r.data.photoList.map((t=>t.url))}))},getPhotoList(){const t=localStorage.getItem("qzoneurl");if(t){const n=t.replace(/(pageStart=)\d+/,"pageStart=0").replace(/(pageNum=)\d+/,"pageNum=10000");this.downJson(n)}else alert("没有获取到相册地址")},getFile(t){return new Promise(((n,e)=>{(0,c.A)({method:"get",url:t,responseType:"blob"}).then((t=>{n(t.data)})).catch((t=>{e(t.toString())}))}))},downLoad(){let t=this.photoList||[];if(t.length<=0)alert("无可导出图片");else{this.loading=!0;let n,e=new(a()),o=[],r={};for(let i=0;i<t.length;i++)n=this.getFile(t[i]).then((t=>{e.file(`${i+1}.jpg`,t,{binary:!0}),r[i]=t})),o.push(n);console.log(o),Promise.all(o).then((()=>{e.generateAsync({type:"blob"}).then((t=>{u().saveAs(t,"相册图片.zip"),this.loading=!1}))})).catch((t=>{console.log(t),this.loading=!1,alert("文件下载失败，请刷新页面并按F12,然后重新下载")}))}}}},d=f,p=e(1656),h=(0,p.A)(d,r,i,!1,null,null,null),g=h.exports;o.Ay.config.productionTip=!1,new o.Ay({render:t=>t(g)}).$mount("#app")}},n={};function e(o){var r=n[o];if(void 0!==r)return r.exports;var i=n[o]={exports:{}};return t[o].call(i.exports,i,i.exports,e),i.exports}e.m=t,function(){var t=[];e.O=function(n,o,r,i){if(!o){var s=1/0;for(c=0;c<t.length;c++){o=t[c][0],r=t[c][1],i=t[c][2];for(var a=!0,l=0;l<o.length;l++)(!1&i||s>=i)&&Object.keys(e.O).every((function(t){return e.O[t](o[l])}))?o.splice(l--,1):(a=!1,i<s&&(s=i));if(a){t.splice(c--,1);var u=r();void 0!==u&&(n=u)}}return n}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[o,r,i]}}(),function(){e.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(n,{a:n}),n}}(),function(){e.d=function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)}}(),function(){e.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};e.O.j=function(n){return 0===t[n]};var n=function(n,o){var r,i,s=o[0],a=o[1],l=o[2],u=0;if(s.some((function(n){return 0!==t[n]}))){for(r in a)e.o(a,r)&&(e.m[r]=a[r]);if(l)var c=l(e)}for(n&&n(o);u<s.length;u++)i=s[u],e.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return e.O(c)},o=self["webpackChunkdown_pic_all"]=self["webpackChunkdown_pic_all"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=e.O(void 0,[504],(function(){return e(4554)}));o=e.O(o)})();
//# sourceMappingURL=app.75cee70c.js.map